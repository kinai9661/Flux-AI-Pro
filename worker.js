// 完整版本代码太长，在此省略前面相同部分...
// 请参考 GitHub 上的最终版本